!function(c){function s(){c.ajax({url:C,cache:!1}).done(function(t){k.html('<div class="vbox-inline">'+t+"</div>"),i()}).fail(function(){k.html('<div class="vbox-inline"><p>Error retrieving contents, please retry</div>'),i()})}function v(){k.html('<iframe class="venoframe" src="'+C+'"></iframe>'),i()}function f(t){var a=C.split("/"),e=a[a.length-1],o=t?"?autoplay=1":"";k.html('<iframe class="venoframe" webkitallowfullscreen mozallowfullscreen allowfullscreen frameborder="0" src="//player.vimeo.com/video/'+e+o+'"></iframe>'),i()}function m(t){var a=C.split("/"),e=a[a.length-1],o=t?"?autoplay=1":"";k.html('<iframe class="venoframe" webkitallowfullscreen mozallowfullscreen allowfullscreen src="//www.youtube.com/embed/'+e+o+'"></iframe>'),i()}function b(){k.html('<div class="vbox-inline">'+c(C).html()+"</div>"),i()}function h(){c(".vbox-content").find("img").one("load",function(){i()}).each(function(){this.complete&&c(this).load()})}function i(){p.html(X),k.find(">:first-child").addClass("figlio"),c(".figlio").css("width",q).css("height",z).css("padding",y).css("background",g),e=k.outerHeight(),a=c(window).height(),e+80<a?(t=(a-e)/2,k.css("margin-top",t),k.css("margin-bottom",t)):(k.css("margin-top","40px"),k.css("margin-bottom","40px")),k.animate({opacity:"1"},"slow")}var u,g,x,p,y,w,k,C,j,q,z,H,D,E,t,L,P,Q,X,A,B,F,a,e,G,I;c.fn.extend({venobox:function(t){var d=c.extend({framewidth:"",frameheight:"",border:"0",bgcolor:"#fff",titleattr:"title",numeratio:!1,infinigall:!1,overlayclose:!0},t);return this.each(function(){var r=c(this);return!!r.data("venobox")||(r.addClass("vbox-item"),r.data("framewidth",d.framewidth),r.data("frameheight",d.frameheight),r.data("border",d.border),r.data("bgcolor",d.bgcolor),r.data("numeratio",d.numeratio),r.data("infinigall",d.infinigall),r.data("overlayclose",d.overlayclose),r.data("venobox",!0),void r.click(function(t){function a(){A=r.data("gall"),L=r.data("numeratio"),H=r.data("infinigall"),1<(D=c('.vbox-item[data-gall="'+A+'"]')).length&&!0===L?(x.html(D.index(r)+1+" / "+D.length),x.show()):x.hide(),B=D.eq(D.index(r)+1),F=D.eq(D.index(r)-1),r.attr(d.titleattr)?(X=r.attr(d.titleattr),p.show()):(X="",p.hide()),1<D.length&&!0===H?(I=G=!0,B.length<1&&(B=D.eq(0)),D.index(r)<1&&(F=D.eq(D.index(D.length)))):(G=0<B.length?(c(".vbox-next").css("display","block"),!0):(c(".vbox-next").css("display","none"),!1),I=0<D.index(r)?(c(".vbox-prev").css("display","block"),!0):(c(".vbox-prev").css("display","none"),!1))}function e(t){27===t.keyCode&&o()}function o(){c("body").removeClass("vbox-open"),c("body").unbind("keydown",e),Q.animate({opacity:0},500,function(){Q.remove(),E=!1,r.focus()})}t.stopPropagation(),t.preventDefault(),r=c(this),P=r.data("overlay"),q=r.data("framewidth"),z=r.data("frameheight"),u=r.data("autoplay")||!1,y=r.data("border"),g=r.data("bgcolor"),E=I=G=!1,C=r.data("href")||r.attr("href"),j=r.data("css")||"",c("body").addClass("vbox-open"),w='<div class="vbox-overlay '+j+'" style="background:'+P+'"><div class="vbox-preloader">Loading...</div><div class="vbox-container"><div class="vbox-content"></div></div><div class="vbox-title"></div><div class="vbox-num">0/0</div><div class="vbox-close">X</div><div class="vbox-next">next</div><div class="vbox-prev">prev</div></div>',c("body").append(w),Q=c(".vbox-overlay"),c(".vbox-container"),k=c(".vbox-content"),x=c(".vbox-num"),p=c(".vbox-title"),k.html(""),k.css("opacity","0"),a(),Q.css("min-height",c(window).outerHeight()),Q.animate({opacity:1},250,function(){"iframe"==r.data("type")?v():"inline"==r.data("type")?b():"ajax"==r.data("type")?s():"vimeo"==r.data("type")?f(u):"youtube"==r.data("type")?m(u):(k.html('<img src="'+C+'">'),h())});var i=function(){E||(E=!0,P=F.data("overlay"),q=F.data("framewidth"),z=F.data("frameheight"),y=F.data("border"),g=F.data("bgcolor"),C=F.data("href")||F.attr("href"),u=F.data("autoplay"),X=F.attr(d.titleattr)?F.attr(d.titleattr):"",void 0===P&&(P=""),k.animate({opacity:0},500,function(){Q.css("background",P),"iframe"==F.data("type")?v():"inline"==F.data("type")?b():"ajax"==F.data("type")?s():"youtube"==F.data("type")?m(u):"vimeo"==F.data("type")?f(u):(k.html('<img src="'+C+'">'),h()),r=F,a(),E=!1}))},n=function(){E||(E=!0,P=B.data("overlay"),q=B.data("framewidth"),z=B.data("frameheight"),y=B.data("border"),g=B.data("bgcolor"),C=B.data("href")||B.attr("href"),u=B.data("autoplay"),X=B.attr(d.titleattr)?B.attr(d.titleattr):"",void 0===P&&(P=""),k.animate({opacity:0},500,function(){Q.css("background",P),"iframe"==B.data("type")?v():"inline"==B.data("type")?b():"ajax"==B.data("type")?s():"youtube"==B.data("type")?m(u):"vimeo"==B.data("type")?f(u):(k.html('<img src="'+C+'">'),h()),r=B,a(),E=!1}))};c("body").keydown(function(t){37==t.keyCode&&1==I&&i(),39==t.keyCode&&1==G&&n()}),c(".vbox-prev").click(function(){i()}),c(".vbox-next").click(function(){n()});var l=".vbox-close, .vbox-overlay";return r.data("overlayclose")||(l=".vbox-close"),c(l).click(function(t){".figlio",".vbox-prev",".vbox-next",".figlio *",c(t.target).is(".figlio")||c(t.target).is(".vbox-next")||c(t.target).is(".vbox-prev")||c(t.target).is(".figlio *")||o()}),c("body").keydown(e),!1}))})}}),c(window).resize(function(){c(".vbox-content").length&&(e=k.height(),a=c(window).height(),e+80<a?(t=(a-e)/2,k.css("margin-top",t),k.css("margin-bottom",t)):(k.css("margin-top","40px"),k.css("margin-bottom","40px")))})}(jQuery);